package pathfinder.scraper.remote.d20pfsrd;

import java.io.IOException;
import java.net.URL;
import java.util.Optional;
import org.springframework.stereotype.Component;
import pathfinder.model.AttributeType;
import pathfinder.model.Description;
import pathfinder.model.Id;
import pathfinder.model.pathfinder.Feature;
import pathfinder.util.NameToIdConverter;
import pathfinder.util.NameUtils;

@Component
public class D20pdsrdArcanistExploitsScraper extends AbstractD20pfsrdTablePageScraper<Feature> {

    @Override
    protected Optional<Feature> transformRow(Row row) {
        if (row.size() != 4) {
            return Optional.empty();
        }

        String name = NameUtils.fixNameOrder(row.text(0));
        Id id = NameToIdConverter.generateId(AttributeType.ARCANIST_EXPLOIT, name);
        String prerequisites = row.text(1);
        Description description = Description.create(row.text(2));
        String source = row.text(3);

        return Optional.of(Feature.builder()
                        .id(id)
                        .name(name)
                        .description(description)
                        .prerequisites(prerequisites)
                        .source(source)
                .build());
    }

    @Override
    protected URL url() throws IOException {
        return new URL("https://www.d20pfsrd.com/classes/hybrid-classes/arcanist/arcane-exploits/");
    }
}
